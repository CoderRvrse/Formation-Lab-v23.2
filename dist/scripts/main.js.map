{
  "version": 3,
  "sources": ["../../scripts/main.js"],
  "sourcesContent": ["// Bootstrap module for Formation Lab v23.4\r\nimport './version.js';\r\nimport { FLAB, PITCH_LAND, PITCH_PORT, PASS_STYLES } from './state.js';\r\nimport { preloadArrowAssets } from './assets.arrows.js';\r\nimport { ensureHalo, relayoutAllPlayers } from './render.js';\r\nimport { initDrag } from './drag.js';\r\nimport { initPassTool } from './pass.js';\r\nimport { setOrientation } from './orientation.js';\r\nimport { wireUI } from './ui.js';\r\nimport { initKeyboard } from './keyboard.js';\r\nimport { loadSettings } from './persist.js';\r\nimport { runAudit } from './audit.js';\r\nimport { applyPreset } from './presets.js';\r\nimport { wirePresetDropdown } from './ui.presets.menu.js';\r\nimport { wireEraseMenu } from './ui.erase.menu.js';\r\nimport { wirePassStyleMenu } from './ui.passstyle.menu.js';\r\nimport { initPassLayer } from './pass.init.js';\r\nimport { initErrorHandler } from './error-handler.js';\r\nimport { initToastSystem } from './ui-toast.js';\r\nimport { initSpinnerSystem } from './loading-spinner.js';\r\nimport { initTouchGestures } from './touch-gestures.js';\r\nimport { initBottomSheetSystem } from './bottom-sheet.js';\r\nimport { initAccessibility, addLandmarks, addAriaLabels, addSkipLink } from './accessibility.js';\r\nimport { initUndoRedo, saveUndoState } from './undo-redo.js';\r\nimport { initTheme } from './theme.js';\r\nimport { initShare } from './share.js';\r\nimport { initFullscreen } from './fullscreen.js';\r\nimport { initPlayerEditor } from './player-editor.js';\r\nimport { initBorderAnimations } from './border-animations.js';\r\n\r\nconsole.log(`\uD83D\uDE80 Formation Lab ${FLAB.version} starting...`);\r\n\r\n// Initialize error handling, toast notifications, loading spinners, bottom sheets, accessibility, and theme\r\ninitErrorHandler();\r\ninitToastSystem();\r\ninitSpinnerSystem();\r\ninitBottomSheetSystem();\r\ninitAccessibility();\r\ninitTheme(); // Initialize theme early to prevent flash\r\n\r\n// Preload pitch assets to eliminate 404s\r\nconst preloadImg1 = new Image();\r\nconst preloadImg2 = new Image();\r\npreloadImg1.src = PITCH_LAND;\r\npreloadImg2.src = PITCH_PORT;\r\n\r\nwindow.addEventListener('DOMContentLoaded', async () => {\r\n  console.log('\uD83D\uDCC4 DOM loaded, initializing modules...');\r\n\r\n  // Preload arrow assets for markers and export parity\r\n  await preloadArrowAssets(PASS_STYLES);\r\n\r\n  // Preload arrow head symbols for transform-based heads\r\n  const { preloadArrowHeads } = await import('./assets.arrows.js');\r\n  await preloadArrowHeads();\r\n\r\n  // Load user settings first\r\n  loadSettings();\r\n\r\n  // Initialize default formation if no players exist\r\n  if (!FLAB.players || FLAB.players.length === 0) {\r\n    applyPreset('4-3-3');\r\n  }\r\n\r\n  // Initialize core components\r\n  ensureHalo();\r\n  setOrientation(FLAB.orientation || 'landscape');\r\n  relayoutAllPlayers();\r\n\r\n  // Initialize interaction systems\r\n  initDrag();\r\n  initPassTool();\r\n  initKeyboard();\r\n  initTouchGestures(); // Mobile touch gestures (pinch-zoom, long-press)\r\n\r\n  // Initialize pass layer (for audit)\r\n  initPassLayer();\r\n\r\n  // Wire up UI\r\n  wireUI();\r\n  wirePresetDropdown();\r\n  wireEraseMenu();\r\n  wirePassStyleMenu();\r\n\r\n  // Initialize accessibility features (ARIA landmarks, labels, skip link)\r\n  addSkipLink();\r\n  addLandmarks();\r\n  addAriaLabels();\r\n\r\n  // Initialize undo/redo system\r\n  initUndoRedo();\r\n\r\n  // Save initial state for undo/redo\r\n  saveUndoState('Initial formation');\r\n\r\n  // Initialize share system\r\n  initShare();\r\n\r\n  // Initialize fullscreen mode\r\n  initFullscreen();\r\n\r\n  // Initialize player editor (double-click to edit)\r\n  initPlayerEditor();\r\n\r\n  // Initialize border and corner animations\r\n  initBorderAnimations();\r\n\r\n  // Initialize ball animation system\r\n  import('./animate.js').then(({ ensureBallLayer, preloadBall }) => {\r\n    ensureBallLayer(document.getElementById('arrow-layer'));\r\n    preloadBall();\r\n  });\r\n\r\n  // Ensure proper layer ordering for ball visibility\r\n  import('./render.js').then(({ ensureLayerOrder }) => {\r\n    ensureLayerOrder();\r\n  });\r\n\r\n  // Assert overlay alignment at boot\r\n  (() => {\r\n    const field = document.querySelector('.flab-field');\r\n    const overlay = document.getElementById('arrow-layer');\r\n    const ok = overlay?.parentElement === field &&\r\n               getComputedStyle(field).position === 'relative' &&\r\n               getComputedStyle(overlay).position === 'absolute';\r\n    if (!ok) console.error('Arrow overlay misaligned: place #arrow-layer inside .flab-field with position:absolute;inset:0');\r\n  })();\r\n\r\n  console.log(`\u2705 Formation Lab ${FLAB.version} ready!`);\r\n\r\n  // Run audit on localhost/dev only\r\n  if (location.hostname === '127.0.0.1' || location.hostname === 'localhost') {\r\n    setTimeout(() => runAudit(), 500); // Allow modules to fully initialize\r\n  }\r\n});\r\n"],
  "mappings": "AACA,MAAO,eACP,OAAS,QAAAA,EAAM,cAAAC,EAAY,cAAAC,EAAY,eAAAC,MAAmB,aAC1D,OAAS,sBAAAC,MAA0B,qBACnC,OAAS,cAAAC,EAAY,sBAAAC,MAA0B,cAC/C,OAAS,YAAAC,MAAgB,YACzB,OAAS,gBAAAC,MAAoB,YAC7B,OAAS,kBAAAC,MAAsB,mBAC/B,OAAS,UAAAC,MAAc,UACvB,OAAS,gBAAAC,MAAoB,gBAC7B,OAAS,gBAAAC,MAAoB,eAC7B,OAAS,YAAAC,MAAgB,aACzB,OAAS,eAAAC,MAAmB,eAC5B,OAAS,sBAAAC,MAA0B,uBACnC,OAAS,iBAAAC,MAAqB,qBAC9B,OAAS,qBAAAC,MAAyB,yBAClC,OAAS,iBAAAC,MAAqB,iBAC9B,OAAS,oBAAAC,MAAwB,qBACjC,OAAS,mBAAAC,MAAuB,gBAChC,OAAS,qBAAAC,MAAyB,uBAClC,OAAS,qBAAAC,MAAyB,sBAClC,OAAS,yBAAAC,MAA6B,oBACtC,OAAS,qBAAAC,EAAmB,gBAAAC,EAAc,iBAAAC,EAAe,eAAAC,MAAmB,qBAC5E,OAAS,gBAAAC,EAAc,iBAAAC,MAAqB,iBAC5C,OAAS,aAAAC,MAAiB,aAC1B,OAAS,aAAAC,MAAiB,aAC1B,OAAS,kBAAAC,MAAsB,kBAC/B,OAAS,oBAAAC,MAAwB,qBACjC,OAAS,wBAAAC,MAA4B,yBAErC,QAAQ,IAAI,2BAAoBlC,EAAK,OAAO,cAAc,EAG1DmB,EAAiB,EACjBC,EAAgB,EAChBC,EAAkB,EAClBE,EAAsB,EACtBC,EAAkB,EAClBM,EAAU,EAGV,MAAMK,EAAc,IAAI,MAClBC,EAAc,IAAI,MACxBD,EAAY,IAAMlC,EAClBmC,EAAY,IAAMlC,EAElB,OAAO,iBAAiB,mBAAoB,SAAY,CACtD,QAAQ,IAAI,+CAAwC,EAGpD,MAAME,EAAmBD,CAAW,EAGpC,KAAM,CAAE,kBAAAkC,CAAkB,EAAI,KAAM,QAAO,oBAAoB,EAC/D,MAAMA,EAAkB,EAGxBzB,EAAa,GAGT,CAACZ,EAAK,SAAWA,EAAK,QAAQ,SAAW,IAC3Cc,EAAY,OAAO,EAIrBT,EAAW,EACXI,EAAeT,EAAK,aAAe,WAAW,EAC9CM,EAAmB,EAGnBC,EAAS,EACTC,EAAa,EACbG,EAAa,EACbW,EAAkB,EAGlBJ,EAAc,EAGdR,EAAO,EACPK,EAAmB,EACnBC,EAAc,EACdC,EAAkB,EAGlBU,EAAY,EACZF,EAAa,EACbC,EAAc,EAGdE,EAAa,EAGbC,EAAc,mBAAmB,EAGjCE,EAAU,EAGVC,EAAe,EAGfC,EAAiB,EAGjBC,EAAqB,EAGrB,OAAO,cAAc,EAAE,KAAK,CAAC,CAAE,gBAAAI,EAAiB,YAAAC,CAAY,IAAM,CAChED,EAAgB,SAAS,eAAe,aAAa,CAAC,EACtDC,EAAY,CACd,CAAC,EAGD,OAAO,aAAa,EAAE,KAAK,CAAC,CAAE,iBAAAC,CAAiB,IAAM,CACnDA,EAAiB,CACnB,CAAC,GAGA,IAAM,CACL,MAAMC,EAAQ,SAAS,cAAc,aAAa,EAC5CC,EAAU,SAAS,eAAe,aAAa,EAC1CA,GAAS,gBAAkBD,GAC3B,iBAAiBA,CAAK,EAAE,WAAa,YACrC,iBAAiBC,CAAO,EAAE,WAAa,YACzC,QAAQ,MAAM,gGAAgG,CACzH,GAAG,EAEH,QAAQ,IAAI,wBAAmB1C,EAAK,OAAO,SAAS,GAGhD,SAAS,WAAa,aAAe,SAAS,WAAa,cAC7D,WAAW,IAAMa,EAAS,EAAG,GAAG,CAEpC,CAAC",
  "names": ["FLAB", "PITCH_LAND", "PITCH_PORT", "PASS_STYLES", "preloadArrowAssets", "ensureHalo", "relayoutAllPlayers", "initDrag", "initPassTool", "setOrientation", "wireUI", "initKeyboard", "loadSettings", "runAudit", "applyPreset", "wirePresetDropdown", "wireEraseMenu", "wirePassStyleMenu", "initPassLayer", "initErrorHandler", "initToastSystem", "initSpinnerSystem", "initTouchGestures", "initBottomSheetSystem", "initAccessibility", "addLandmarks", "addAriaLabels", "addSkipLink", "initUndoRedo", "saveUndoState", "initTheme", "initShare", "initFullscreen", "initPlayerEditor", "initBorderAnimations", "preloadImg1", "preloadImg2", "preloadArrowHeads", "ensureBallLayer", "preloadBall", "ensureLayerOrder", "field", "overlay"]
}
