var d=Object.defineProperty;var n=(e,t)=>d(e,"name",{value:t,configurable:!0});import{FLAB as a}from"./state.js";import{n2p_view as l,p2n_view as c,clampPx as u}from"./geometry.js";import{playerEls as p}from"./drag.js";const y="http://www.w3.org/2000/svg";function L(e){const t=document.getElementById("arrow-layer");if(!t)return null;let r=document.getElementById(e);return r||(r=document.createElementNS(y,"g"),r.id=e,r.setAttribute("pointer-events","none"),t.appendChild(r)),r}n(L,"ensureLayer");function A(){const e=document.getElementById("arrow-layer");if(!e){console.warn("ensureLayerOrder: #arrow-layer not found");return}const t=document.getElementById("arrow-group");if(!t){console.warn("ensureLayerOrder: #arrow-group not found");return}let r=document.getElementById("ball-layer");r||(r=document.createElementNS("http://www.w3.org/2000/svg","g"),r.id="ball-layer",r.setAttribute("pointer-events","none")),r.parentNode!==t&&t.appendChild(r);let o=document.getElementById("arrow-debug-layer");o||(o=document.createElementNS("http://www.w3.org/2000/svg","g"),o.id="arrow-debug-layer",o.setAttribute("pointer-events","none"),e.appendChild(o)),console.log("\u{1F3A8} Layer order ensured: ball-layer inside arrow-group (same transforms)")}n(A,"ensureLayerOrder");function I(e){return document.querySelector(`.player[data-id="${e}"]`)}n(I,"playerEl");function B(){document.querySelectorAll(".player[data-aim]").forEach(e=>e.removeAttribute("data-aim"))}n(B,"clearAimTags");function m(e){const t=l(e.nx,e.ny),r=u(t.x,t.y);if(r.x!==t.x||r.y!==t.y){const o=c(r.x,r.y);e.nx=Math.min(1,Math.max(0,o.nx)),e.ny=Math.min(1,Math.max(0,o.ny))}}n(m,"clampPlayerCanonical");function i(e,t){const{x:r,y:o}=l(t.nx,t.ny);e.style.left=`${r}px`,e.style.top=`${o}px`}n(i,"placePlayerEl");function f(){(a.players||[]).forEach(m);for(const e of a.players){const t=document.querySelector(`.flab-player[data-id="${e.id}"]`);t&&i(t,e)}}n(f,"relayoutAllPlayers");function x(){let e=document.getElementById("flabHalo");if(!e){console.warn("Creating fallback halo element"),e=document.createElement("div"),e.id="flabHalo",e.className="flab-halo",e.style.cssText="position:absolute;width:56px;height:56px;pointer-events:none;opacity:0;",e.setAttribute("aria-hidden","true");const t=document.getElementById("formationField");t&&t.appendChild(e)}return e.style.pointerEvents="none",e}n(x,"ensureHalo");function g(){const e=x();if(!a.selectedId){e.classList.remove("is-visible");return}const t=a.players.find(s=>s.id===a.selectedId);if(!t){e.classList.remove("is-visible");return}const{x:r,y:o}=l(t.nx,t.ny);e.style.left=`${r}px`,e.style.top=`${o}px`,e.classList.add("is-visible")}n(g,"updateHalo");function S(){a.players.forEach(e=>{const t=p.get(e.id);t&&i(t,e)})}n(S,"renderPlayers");function w(){import("./pass.js").then(({renderArrows:e})=>{e()})}n(w,"renderArrows");function C(){f(),g(),w()}n(C,"handleResize"),window.__mod_render=!0;export{B as clearAimTags,x as ensureHalo,L as ensureLayer,A as ensureLayerOrder,C as handleResize,i as placePlayerEl,I as playerEl,f as relayoutAllPlayers,w as renderArrows,S as renderPlayers,g as updateHalo};
//# sourceMappingURL=render.js.map
