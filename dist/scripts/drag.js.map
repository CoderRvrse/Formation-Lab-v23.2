{
  "version": 3,
  "sources": ["../../scripts/drag.js"],
  "sourcesContent": ["// Drag module for Formation Lab\r\nimport { FLAB } from './state.js';\r\nimport { n2p_view, p2n_view, clampPx, toView } from './geometry.js';\r\nimport { beginPassPreview, updatePassPreview, commitPass } from './pass.js';\r\n\r\nconst SLOP_PX = 6;\r\nconst ROLE_LABELS = {\r\n  GK: \"goalkeeper\",\r\n  DF: \"defender\",\r\n  MF: \"midfielder\",\r\n  FW: \"forward\"\r\n};\r\n\r\nlet playerEls = new Map();\r\nlet field = null;\r\nlet _stream = null; // active pointer stream\r\n\r\nfunction getLocalPoint(evt, container) {\r\n  const rect = container.getBoundingClientRect();\r\n  return {\r\n    x: evt.clientX - rect.left,\r\n    y: evt.clientY - rect.top\r\n  };\r\n}\r\n\r\nfunction getPlayer(playerId) {\r\n  return FLAB.players.find(player => player.id === playerId) || null;\r\n}\r\n\r\nfunction hitPlayer(evt) {\r\n  const playerEl = evt.target.closest('.player[data-id]');\r\n  if (!playerEl) return null;\r\n  return { id: parseInt(playerEl.dataset.id) };\r\n}\r\n\r\nfunction startPointerStream(ev) {\r\n  // anchor listeners at window so we never miss moves\r\n  if (_stream) return;\r\n  _stream = {\r\n    id: ev.pointerId,\r\n    move: e => {\r\n      if (!FLAB.passArm?.drawing) return;\r\n      const v = toView(e.clientX, e.clientY);\r\n      updatePassPreview(v);\r\n    },\r\n    up: e => {\r\n      if (!_stream || e.pointerId !== _stream.id) return;\r\n      window.removeEventListener('pointermove', _stream.move, true);\r\n      window.removeEventListener('pointerup', _stream.up, true);\r\n      window.removeEventListener('pointercancel', _stream.up, true);\r\n      try { document.getElementById('pitchMount')?.releasePointerCapture(_stream.id); } catch {}\r\n      _stream = null;\r\n      if (FLAB.passArm?.drawing) commitPass();\r\n    }\r\n  };\r\n  window.addEventListener('pointermove', _stream.move, true);\r\n  window.addEventListener('pointerup', _stream.up, true);\r\n  window.addEventListener('pointercancel', _stream.up, true);\r\n  // capture on the stable container (not the tiny child)\r\n  try { document.getElementById('pitchMount')?.setPointerCapture(ev.pointerId); } catch {}\r\n}\r\n\r\nfunction selectPlayer(playerId) {\r\n  const previous = FLAB.selectedId;\r\n  if (playerId === FLAB.selectedId) {\r\n    FLAB.selectedId = null;\r\n  } else {\r\n    FLAB.selectedId = playerId ?? null;\r\n  }\r\n\r\n  // Import and call updateHalo when needed\r\n  if (previous !== FLAB.selectedId) {\r\n    import('./render.js').then(({ updateHalo }) => {\r\n      updateHalo();\r\n    });\r\n  }\r\n}\r\n\r\nfunction removeArrowsByPlayer(playerId) {\r\n  const before = FLAB.arrows.length;\r\n  FLAB.arrows = FLAB.arrows.filter(arrow => arrow.fromId !== playerId);\r\n  if (before !== FLAB.arrows.length) {\r\n    import('./render.js').then(({ renderArrows }) => {\r\n      renderArrows();\r\n    });\r\n  }\r\n}\r\n\r\nfunction createPlayerElement(player) {\r\n  const el = document.createElement(\"div\");\r\n  el.className = \"flab-player player\";\r\n  el.dataset.id = String(player.id);\r\n  el.dataset.role = player.role;\r\n  el.tabIndex = 0;\r\n  el.setAttribute(\"role\", \"button\");\r\n  el.setAttribute(\"aria-label\", `Player ${player.id}, ${ROLE_LABELS[player.role]}`);\r\n  el.innerHTML = `\r\n    <img class=\"jersey\" src=\"assets/jersey.svg\" alt=\"\" draggable=\"false\" />\r\n    <span class=\"num\">${player.id}</span>\r\n  `;\r\n\r\n  el.addEventListener(\"pointerdown\", onPointerDown);\r\n  el.addEventListener(\"pointermove\", evt => onPlayerPointerMove(evt, player.id));\r\n  el.addEventListener(\"pointerup\", evt => onPlayerPointerUp(evt, player.id));\r\n  el.addEventListener(\"pointercancel\", evt => onPlayerPointerUp(evt, player.id));\r\n\r\n  el.addEventListener(\"keydown\", evt => onPlayerKeyDown(evt, player.id));\r\n\r\n  return el;\r\n}\r\n\r\nexport function onPointerDown(evt) {\r\n  // stop bubbling through jersey/img/badge layers\r\n  evt.stopPropagation();\r\n  evt.preventDefault();\r\n\r\n  const hit = hitPlayer(evt);\r\n  if (!hit) return;\r\n\r\n  if (FLAB.mode === 'pass') {\r\n    if (FLAB.passArm?.drawing) return;   // guard: prevent duplicate begins\r\n    console.log('[pass] begin from player', hit.id);\r\n    FLAB.activePlayer = getPlayer(hit.id);\r\n    beginPassPreview(FLAB.activePlayer);\r\n    startPointerStream(evt);\r\n    return;\r\n  }\r\n\r\n  // \u2026 existing select/drag logic\r\n  const el = playerEls.get(hit.id);\r\n  const player = getPlayer(hit.id);\r\n  if (!el || !player) return;\r\n\r\n  if (FLAB.mode === \"erase\") {\r\n    removeArrowsByPlayer(hit.id);\r\n    return;\r\n  }\r\n\r\n  // Add pressing class to kill hover transitions immediately\r\n  field.classList.remove(\"can-hover\");\r\n  field.classList.add(\"lab-pressing\", \"is-engaged\");\r\n\r\n  const localPoint = getLocalPoint(evt, field);\r\n  const { x: centerX, y: centerY } = n2p_view(player.nx, player.ny);\r\n  const center = { x: centerX, y: centerY };\r\n\r\n  selectPlayer(hit.id);\r\n\r\n  evt.preventDefault();\r\n  el.setPointerCapture(evt.pointerId);\r\n  el.classList.add(\"is-grabbing\");\r\n  // Add will-change for better performance during drag\r\n  el.style.willChange = 'transform';\r\n  FLAB.drag = {\r\n    pointerId: evt.pointerId,\r\n    playerId: hit.id,\r\n    origin: localPoint,\r\n    grabDX: center.x - localPoint.x,\r\n    grabDY: center.y - localPoint.y,\r\n    started: false\r\n  };\r\n}\r\n\r\nfunction onPlayerPointerMove(evt, playerId) {\r\n  if (FLAB.passArm && FLAB.passArm.fromId === playerId && FLAB.passArm.pointerId === evt.pointerId) {\r\n    const v = toView(evt.clientX, evt.clientY);\r\n    FLAB.passArm.latest = v;\r\n\r\n    // Check for curve mode with Alt key\r\n    FLAB.passArm.curved = evt.altKey;\r\n    if (FLAB.passArm.curved) {\r\n      // Add perpendicular offset for curved passes\r\n      const dx = v.x - FLAB.passArm.origin.x;\r\n      const dy = v.y - FLAB.passArm.origin.y;\r\n      const midX = FLAB.passArm.origin.x + dx * 0.5;\r\n      const midY = FLAB.passArm.origin.y + dy * 0.5;\r\n      const perpX = -dy * 0.3; // perpendicular offset\r\n      const perpY = dx * 0.3;\r\n      FLAB.passArm.control = {\r\n        x: midX + perpX,\r\n        y: midY + perpY\r\n      };\r\n    } else {\r\n      FLAB.passArm.control = null;\r\n    }\r\n\r\n    // Import and call pass preview\r\n    import('./pass.js').then(({ updatePassPreview }) => {\r\n      updatePassPreview(v);\r\n    });\r\n    return;\r\n  }\r\n\r\n  if (!FLAB.drag || FLAB.drag.playerId !== playerId || FLAB.drag.pointerId !== evt.pointerId) {\r\n    return;\r\n  }\r\n\r\n  const localPoint = getLocalPoint(evt, field);\r\n  const player = getPlayer(playerId);\r\n  if (!player) return;\r\n\r\n  const dx = localPoint.x - FLAB.drag.origin.x;\r\n  const dy = localPoint.y - FLAB.drag.origin.y;\r\n  const distance = Math.hypot(dx, dy);\r\n\r\n  if (!FLAB.drag.started && distance < SLOP_PX) {\r\n    return;\r\n  }\r\n\r\n  evt.preventDefault();\r\n\r\n  if (!FLAB.drag.started) {\r\n    FLAB.drag.started = true;\r\n    field.classList.add(\"is-engaged\");\r\n  }\r\n\r\n  // Calculate new position in px space\r\n  let nxPx = localPoint.x + FLAB.drag.grabDX;\r\n  let nyPx = localPoint.y + FLAB.drag.grabDY;\r\n\r\n  // Clamp to playable rect\r\n  ({ x: nxPx, y: nyPx } = clampPx(nxPx, nyPx));\r\n\r\n  // Compute canonical norm from current view\r\n  const canon = p2n_view(nxPx, nyPx);\r\n  player.nx = Math.min(1, Math.max(0, canon.nx));\r\n  player.ny = Math.min(1, Math.max(0, canon.ny));\r\n\r\n  // Re-place via view mapping (keeps pixel under cursor)\r\n  const px = n2p_view(player.nx, player.ny);\r\n  const el = playerEls.get(playerId);\r\n  if (el) {\r\n    el.style.left = `${px.x}px`;\r\n    el.style.top = `${px.y}px`;\r\n  }\r\n\r\n  // Import and call render functions\r\n  import('./render.js').then(({ updateHalo, renderArrows }) => {\r\n    updateHalo();\r\n    renderArrows();\r\n  });\r\n}\r\n\r\nfunction onPlayerPointerUp(evt, playerId) {\r\n  const el = playerEls.get(playerId);\r\n\r\n  if (FLAB.passArm && FLAB.passArm.fromId === playerId && FLAB.passArm.pointerId === evt.pointerId) {\r\n    evt.preventDefault();\r\n    el?.classList.remove(\"is-grabbing\");\r\n    if (el) el.style.willChange = 'auto'; // Reset will-change after drag\r\n    if (el?.hasPointerCapture?.(evt.pointerId)) {\r\n      el.releasePointerCapture(evt.pointerId);\r\n    }\r\n\r\n    if (FLAB.passArm?.drawing) {\r\n      console.log('[pass] commit');\r\n      // Use commitPass which handles passArm cleanup\r\n      import('./pass.js').then(({ commitPass }) => {\r\n        commitPass();\r\n      });\r\n    } else {\r\n      FLAB.passArm = null;\r\n    }\r\n\r\n    // Hide preview\r\n    import('./pass.js').then(({ updatePassPreview }) => {\r\n      updatePassPreview(null, null);\r\n    });\r\n\r\n    field.classList.remove(\"lab-pressing\", \"is-engaged\");\r\n    field.classList.add(\"can-hover\");\r\n    return;\r\n  }\r\n\r\n  if (!FLAB.drag || FLAB.drag.playerId !== playerId || FLAB.drag.pointerId !== evt.pointerId) {\r\n    return;\r\n  }\r\n\r\n  evt.preventDefault();\r\n  el?.classList.remove(\"is-grabbing\");\r\n  if (el) el.style.willChange = 'auto'; // Reset will-change after drag\r\n\r\n  if (FLAB.drag.started) {\r\n    if (el?.hasPointerCapture?.(evt.pointerId)) {\r\n      el.releasePointerCapture(evt.pointerId);\r\n    }\r\n  }\r\n\r\n  field.classList.remove(\"lab-pressing\", \"is-engaged\");\r\n  field.classList.add(\"can-hover\");\r\n\r\n  FLAB.drag = null;\r\n}\r\n\r\nfunction onPlayerKeyDown(evt, playerId) {\r\n  if (evt.key === \"Enter\" || evt.key === \" \") {\r\n    evt.preventDefault();\r\n    selectPlayer(playerId);\r\n  }\r\n}\r\n\r\nexport function initDrag() {\r\n  field = document.querySelector('.flab-field');\r\n  if (!field) {\r\n    console.error('Cannot initialize drag: .flab-field not found');\r\n    return;\r\n  }\r\n\r\n  // Get player container\r\n  const playersLayer = document.querySelector('.flab-players');\r\n  if (!playersLayer) {\r\n    console.error('Cannot initialize drag: .flab-players not found');\r\n    return;\r\n  }\r\n\r\n  // Clear existing players and rebuild\r\n  playersLayer.innerHTML = \"\";\r\n  playerEls.clear();\r\n\r\n  FLAB.players.forEach(player => {\r\n    const el = createPlayerElement(player);\r\n    playersLayer.appendChild(el);\r\n    playerEls.set(player.id, el);\r\n  });\r\n\r\n  // Import and call render functions\r\n  import('./render.js').then(({ renderPlayers, renderArrows, updateHalo }) => {\r\n    renderPlayers();\r\n    renderArrows();\r\n    updateHalo();\r\n  });\r\n\r\n  field.classList.add(\"can-hover\");\r\n}\r\n\r\nexport { playerEls };\r\n\r\nwindow.__mod_drag = true;"],
  "mappings": "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",
  "names": ["FLAB", "n2p_view", "p2n_view", "clampPx", "toView", "beginPassPreview", "updatePassPreview", "commitPass", "SLOP_PX", "ROLE_LABELS", "playerEls", "field", "_stream", "getLocalPoint", "evt", "container", "rect", "__name", "getPlayer", "playerId", "player", "hitPlayer", "playerEl", "startPointerStream", "ev", "e", "v", "selectPlayer", "previous", "updateHalo", "removeArrowsByPlayer", "before", "arrow", "renderArrows", "createPlayerElement", "el", "onPointerDown", "onPlayerPointerMove", "onPlayerPointerUp", "onPlayerKeyDown", "hit", "localPoint", "centerX", "centerY", "center", "dx", "dy", "midX", "midY", "perpX", "perpY", "distance", "nxPx", "nyPx", "canon", "px", "initDrag", "playersLayer", "renderPlayers"]
}
