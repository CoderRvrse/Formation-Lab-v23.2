{
  "version": 3,
  "sources": ["../../scripts/export.js"],
  "sourcesContent": ["// Export module for Formation Lab\r\nimport { FLAB, PITCH_LAND, PITCH_PORT, PASS } from './state.js';\r\nimport { normToView, getVar, insetFromA, insetFromB } from './geometry.js';\r\nimport { ARROW_ASSETS } from './assets.arrows.js';\r\nimport { headPxFor, headTrimPx } from './pass.headsize.js';\r\nimport { showSpinner, hideSpinner } from './loading-spinner.js';\r\nimport { handleError } from './error-handler.js';\r\nimport { showSuccessToast, showErrorToast } from './ui-toast.js';\r\nconst JERSEY_SIZE = 56;\r\n\r\n// Bleed configuration (moved from geometry to avoid circular dependency)\r\nconst BLEED = {\r\n  landscape: { left: 24, right: 24, top: 24, bottom: 24 },\r\n  portrait:  { left: 24, right: 24, top: 28, bottom: 28 }\r\n};\r\n\r\n// Jersey image for export\r\nconst jerseyImg = new Image();\r\njerseyImg.src = 'assets/jersey.svg';\r\n\r\nfunction getPlayer(playerId) {\r\n  return FLAB.players.find(player => player.id === playerId) || null;\r\n}\r\n\r\nfunction showToast(message) {\r\n  // Import ui module for toast functionality\r\n  import('./ui.js').then(({ showToast }) => {\r\n    showToast(message);\r\n  }).catch(() => {\r\n    console.log(message); // Fallback\r\n  });\r\n}\r\n\r\nfunction logTelemetry(event, data) {\r\n  console.log(`Telemetry: ${event}`, data);\r\n}\r\n\r\n/**\r\n * Draw border decorations (corner markers, lines, and text)\r\n * to match the animated pitch border styling\r\n */\r\nfunction drawBorderDecorations(ctx, wCss, hCss) {\r\n  const cornerSize = 40;\r\n  const lineWidth = 2;\r\n  const cornerRadius = 8;\r\n\r\n  // FC Barcelona color palette\r\n  const colors = [\r\n    'rgba(0, 77, 152, 0.6)',        // Blue (Blau)\r\n    'rgba(168, 19, 62, 0.6)',       // Claret (Grana)\r\n    'rgba(237, 187, 0, 0.6)',       // Gold\r\n    'rgba(255, 237, 2, 0.6)',       // Yellow (senyera)\r\n    'rgba(219, 0, 48, 0.6)',        // Bright Red\r\n  ];\r\n  const primaryColor = colors[0]; // Use blue as primary for export\r\n\r\n  ctx.save();\r\n\r\n  // Draw corner markers\r\n  const corners = [\r\n    { x: 0, y: 0, label: 'top-left' },\r\n    { x: wCss - cornerSize, y: 0, label: 'top-right' },\r\n    { x: wCss - cornerSize, y: hCss - cornerSize, label: 'bottom-right' },\r\n    { x: 0, y: hCss - cornerSize, label: 'bottom-left' }\r\n  ];\r\n\r\n  corners.forEach((corner, index) => {\r\n    ctx.strokeStyle = primaryColor;\r\n    ctx.lineWidth = lineWidth;\r\n    ctx.beginPath();\r\n\r\n    // Draw corner bracket based on position\r\n    if (index === 0) {\r\n      // Top-left\r\n      ctx.moveTo(corner.x, corner.y + cornerRadius);\r\n      ctx.lineTo(corner.x, corner.y);\r\n      ctx.lineTo(corner.x + cornerRadius, corner.y);\r\n    } else if (index === 1) {\r\n      // Top-right\r\n      ctx.moveTo(corner.x + cornerSize - cornerRadius, corner.y);\r\n      ctx.lineTo(corner.x + cornerSize, corner.y);\r\n      ctx.lineTo(corner.x + cornerSize, corner.y + cornerRadius);\r\n    } else if (index === 2) {\r\n      // Bottom-right\r\n      ctx.moveTo(corner.x + cornerSize, corner.y + cornerSize - cornerRadius);\r\n      ctx.lineTo(corner.x + cornerSize, corner.y + cornerSize);\r\n      ctx.lineTo(corner.x + cornerSize - cornerRadius, corner.y + cornerSize);\r\n    } else if (index === 3) {\r\n      // Bottom-left\r\n      ctx.moveTo(corner.x + cornerRadius, corner.y + cornerSize);\r\n      ctx.lineTo(corner.x, corner.y + cornerSize);\r\n      ctx.lineTo(corner.x, corner.y + cornerSize - cornerRadius);\r\n    }\r\n\r\n    ctx.stroke();\r\n  });\r\n\r\n  // Draw border lines with slight glow effect\r\n  ctx.strokeStyle = primaryColor;\r\n  ctx.lineWidth = lineWidth;\r\n  ctx.shadowColor = 'rgba(0, 77, 152, 0.4)';\r\n  ctx.shadowBlur = 8;\r\n\r\n  // Top line\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, 0);\r\n  ctx.lineTo(wCss, 0);\r\n  ctx.stroke();\r\n\r\n  // Right line\r\n  ctx.beginPath();\r\n  ctx.moveTo(wCss, 0);\r\n  ctx.lineTo(wCss, hCss);\r\n  ctx.stroke();\r\n\r\n  // Bottom line\r\n  ctx.beginPath();\r\n  ctx.moveTo(wCss, hCss);\r\n  ctx.lineTo(0, hCss);\r\n  ctx.stroke();\r\n\r\n  // Left line\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, hCss);\r\n  ctx.lineTo(0, 0);\r\n  ctx.stroke();\r\n\r\n  ctx.restore();\r\n}\r\n\r\nfunction applyCanvasPassStyle(ctx) {\r\n  const s = FLAB.passStyle;\r\n  ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--pass-color').trim() || \"#f0c419\";\r\n\r\n  if (s === 'dashed') {\r\n    ctx.setLineDash([14, 10]);\r\n    ctx.lineWidth = 4;\r\n  } else if (s.startsWith('comic')) {\r\n    ctx.setLineDash([2, 8]);\r\n    ctx.lineWidth = 5;\r\n  } else {\r\n    ctx.setLineDash([]);\r\n    ctx.lineWidth = 4;\r\n  }\r\n}\r\n\r\nfunction clamp(v, min, max) {\r\n  return Math.max(min, Math.min(max, v));\r\n}\r\n\r\n// Recolor SVG content with current pass colors\r\nfunction recolorSVG(svgText, fillColor, strokeColor) {\r\n  return svgText\r\n    .replace(/fill\\s*=\\s*[\"'][^\"']*[\"']/gi, `fill=\"${fillColor}\"`)\r\n    .replace(/stroke\\s*=\\s*[\"'][^\"']*[\"']/gi, `stroke=\"${strokeColor}\"`);\r\n}\r\n\r\n// Create a colored image for the current colors\r\nasync function getColoredImage(styleKey, fillColor, strokeColor) {\r\n  const asset = ARROW_ASSETS.get(styleKey);\r\n  if (!asset) return null;\r\n\r\n  const coloredSVG = recolorSVG(asset.svgText, fillColor, strokeColor);\r\n  const img = new Image();\r\n  img.src = 'data:image/svg+xml;utf8,' + encodeURIComponent(coloredSVG);\r\n  await img.decode().catch(() => {});\r\n  return img;\r\n}\r\n\r\nfunction drawHeadCanvas(ctx, A, B, styleKey) {\r\n  const len = Math.hypot(B.x - A.x, B.y - A.y);\r\n  const isComic = /comic/.test(styleKey);\r\n  const head = headPxFor(len, isComic);\r\n\r\n  const ang = Math.atan2(B.y - A.y, B.x - A.x);\r\n\r\n  // Get current colors for a simple geometric arrow\r\n  const shaftColor = getComputedStyle(document.documentElement).getPropertyValue('--pass-color')?.trim() || PASS.color;\r\n  const outlineColor = getComputedStyle(document.documentElement).getPropertyValue('--pass-outline')?.trim() || PASS.outline;\r\n\r\n  ctx.save();\r\n  ctx.translate(B.x, B.y);\r\n  ctx.rotate(ang);\r\n\r\n  // Draw a simple triangle arrow head using current colors\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, 0);\r\n  ctx.lineTo(-head, head / 2);\r\n  ctx.lineTo(-head, -head / 2);\r\n  ctx.closePath();\r\n\r\n  ctx.fillStyle = shaftColor;\r\n  ctx.fill();\r\n\r\n  ctx.lineWidth = getVar('--pass-head-outline', 1.4);\r\n  ctx.strokeStyle = outlineColor;\r\n  ctx.stroke();\r\n\r\n  ctx.restore();\r\n}\r\n\r\nasync function ensureJerseyReady() {\r\n  if (jerseyImg.complete) {\r\n    if (jerseyImg.naturalWidth > 0) {\r\n      return;\r\n    }\r\n    throw new Error('jersey_unavailable');\r\n  }\r\n  if (typeof jerseyImg.decode === \"function\") {\r\n    try {\r\n      await jerseyImg.decode();\r\n      if (jerseyImg.naturalWidth > 0) {\r\n        return;\r\n      }\r\n    } catch (error) {\r\n      console.warn('jersey_decode_failed', error);\r\n    }\r\n  }\r\n  await new Promise((resolve, reject) => {\r\n    jerseyImg.addEventListener('load', resolve, { once: true });\r\n    jerseyImg.addEventListener('error', () => reject(new Error('Failed to load jersey.svg')), { once: true });\r\n  });\r\n  if (jerseyImg.naturalWidth === 0) {\r\n    throw new Error('jersey_unavailable');\r\n  }\r\n}\r\n\r\nfunction drawJersey(ctx, x, y, size, numText) {\r\n  const half = size / 2;\r\n  const scale = size / JERSEY_SIZE || 1;\r\n  if (jerseyImg.complete && jerseyImg.naturalWidth > 0) {\r\n    ctx.drawImage(jerseyImg, x - half, y - half, size, size);\r\n  } else {\r\n    ctx.save();\r\n    ctx.fillStyle = '#0b2b72';\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, half, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n\r\n  const chipRadius = 14 * scale;\r\n  const offset = 4 * scale;\r\n  const chipX = x + half - chipRadius - offset;\r\n  const chipY = y + half - chipRadius - offset;\r\n\r\n  ctx.save();\r\n  ctx.fillStyle = '#ffd166';\r\n  ctx.strokeStyle = 'rgba(0, 0, 0, 0.12)';\r\n  ctx.lineWidth = Math.max(1, 2 * scale);\r\n  ctx.beginPath();\r\n  ctx.arc(chipX, chipY, chipRadius, 0, Math.PI * 2);\r\n  ctx.fill();\r\n  ctx.stroke();\r\n  ctx.fillStyle = '#0b2b66';\r\n  ctx.font = `${Math.max(12, 14 * scale)}px \"Segoe UI\", Arial, sans-serif`;\r\n  ctx.textAlign = 'center';\r\n  ctx.textBaseline = 'middle';\r\n  ctx.fillText(String(numText), chipX, chipY);\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawArrows(ctx, width, height) {\r\n  ctx.save();\r\n  const passColor = getComputedStyle(document.documentElement).getPropertyValue('--pass-color').trim() || \"#f0c419\";\r\n  ctx.strokeStyle = passColor;\r\n  ctx.fillStyle = passColor;\r\n  applyCanvasPassStyle(ctx);\r\n  ctx.lineCap = \"round\";\r\n\r\n  const avgScale = Math.min(width / 800, height / 600);\r\n\r\n  FLAB.arrows.forEach(arrow => {\r\n    const fromPlayer = getPlayer(arrow.fromId);\r\n    if (!fromPlayer) return;\r\n\r\n    // Use view-aware coordinates for export\r\n    const isExportPortrait = FLAB.orientation === 'portrait';\r\n    const bleed = isExportPortrait ? BLEED.portrait : BLEED.landscape;\r\n    const r = {\r\n      x: bleed.left * (width / 720),\r\n      y: bleed.top * (height / 460),\r\n      w: width - (bleed.left + bleed.right) * (width / 720),\r\n      h: height - (bleed.top + bleed.bottom) * (height / 460)\r\n    };\r\n\r\n    // Apply view transform for export\r\n    const {vx: passerVx, vy: passerVy} = normToView(fromPlayer.nx, fromPlayer.ny);\r\n    const passerCenter = {\r\n      x: r.x + passerVx * r.w,\r\n      y: r.y + passerVy * r.h\r\n    };\r\n\r\n    // Target center needs scaling from original arrow coordinates\r\n    const scaleX = width / (document.querySelector('.flab-field')?.clientWidth || 800);\r\n    const scaleY = height / (document.querySelector('.flab-field')?.clientHeight || 600);\r\n    const targetCenter = { x: arrow.to.x * scaleX, y: arrow.to.y * scaleY };\r\n\r\n    // Create a scaled version of halo-based endpoints for export\r\n    const exportHaloR = 28 * avgScale; // approximate halo radius scaled\r\n    const exportStartGap = getVar('--pass-origin-gap', 1.5) * avgScale;\r\n    const exportEndGap = getVar('--pass-target-gap', 2) * avgScale;\r\n\r\n    // Calculate scaled tight endpoints\r\n    const A = insetFromA(passerCenter.x, passerCenter.y, targetCenter.x, targetCenter.y, exportHaloR + exportStartGap);\r\n    const exportTargetR = 28 * avgScale; // approximate target radius\r\n    const Btip = insetFromB(passerCenter.x, passerCenter.y, targetCenter.x, targetCenter.y, exportTargetR + exportEndGap);\r\n\r\n    // Calculate shaft trim for clean head join\r\n    const len = Math.hypot(Btip.x - A.x, Btip.y - A.y);\r\n    const isComic = /comic/.test(FLAB.passStyle);\r\n    const headPx = headPxFor(len, isComic);\r\n    const trim = headTrimPx(headPx);\r\n\r\n    // Calculate shortened shaft endpoint\r\n    const dx = Btip.x - A.x;\r\n    const dy = Btip.y - A.y;\r\n    const L = len || 1;\r\n    const Bshaft = {\r\n      x: Btip.x - dx * (trim / L),\r\n      y: Btip.y - dy * (trim / L)\r\n    };\r\n\r\n    if (arrow.curved && arrow.control) {\r\n      // For curved passes - need to adjust the curve endpoint\r\n      const scaledControl = { x: arrow.control.x * scaleX, y: arrow.control.y * scaleY };\r\n      ctx.beginPath();\r\n      ctx.moveTo(A.x, A.y);\r\n      ctx.quadraticCurveTo(scaledControl.x, scaledControl.y, Bshaft.x, Bshaft.y);\r\n    } else {\r\n      // For straight passes\r\n      ctx.beginPath();\r\n      ctx.moveTo(A.x, A.y);\r\n      ctx.lineTo(Bshaft.x, Bshaft.y);\r\n    }\r\n\r\n    ctx.stroke();\r\n\r\n    // Draw arrowhead using current style at the tip position\r\n    drawHeadCanvas(ctx, A, Btip, FLAB.passStyle);\r\n  });\r\n\r\n  ctx.restore();\r\n}\r\n\r\nfunction drawPlayers(ctx, width, height) {\r\n  const sizeScale = Math.min(width / 720, height / 460); // Approximate scaling\r\n  FLAB.players.forEach(player => {\r\n    // Use view-aware coordinates and convert to export canvas space\r\n    const isExportPortrait = FLAB.orientation === 'portrait';\r\n    const bleed = isExportPortrait ? BLEED.portrait : BLEED.landscape;\r\n    const r = {\r\n      x: bleed.left * (width / 720),\r\n      y: bleed.top * (height / 460),\r\n      w: width - (bleed.left + bleed.right) * (width / 720),\r\n      h: height - (bleed.top + bleed.bottom) * (height / 460)\r\n    };\r\n\r\n    // Apply view transform for export\r\n    const {vx, vy} = normToView(player.nx, player.ny);\r\n    const x = r.x + vx * r.w;\r\n    const y = r.y + vy * r.h;\r\n    drawJersey(ctx, x, y, JERSEY_SIZE * sizeScale, player.id);\r\n  });\r\n}\r\n\r\nexport async function exportPNG() {\r\n  const spinnerId = showSpinner(\"Exporting formation...\");\r\n\r\n  try {\r\n    const field = document.querySelector('.flab-field');\r\n    const dpr = window.devicePixelRatio || 1;\r\n    const wCss = Math.max(1, field?.clientWidth || 800);\r\n    const hCss = Math.max(1, field?.clientHeight || 600);\r\n\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = Math.round(wCss * dpr);\r\n    canvas.height = Math.round(hCss * dpr);\r\n    const ctx = canvas.getContext(\"2d\");\r\n\r\n    if (!ctx) {\r\n      throw new Error('Canvas context unavailable for export');\r\n    }\r\n\r\n    ctx.scale(dpr, dpr);\r\n\r\n    // Try to load jersey image (non-critical)\r\n    try {\r\n      await ensureJerseyReady();\r\n    } catch (error) {\r\n      console.warn('Jersey image load failed (non-critical):', error);\r\n    }\r\n\r\n    // 1) Draw pitch from active orientation\r\n    const pitchSrc = FLAB.orientation === 'portrait' ? PITCH_PORT : PITCH_LAND;\r\n    const img = new Image();\r\n    img.src = pitchSrc;\r\n\r\n    try {\r\n      await img.decode();\r\n    } catch (error) {\r\n      throw new Error('Failed to load pitch image. Please try again.');\r\n    }\r\n\r\n    ctx.drawImage(img, 0, 0, wCss, hCss);\r\n\r\n    // 2) Draw arrows/jerseys/halo-based passes\r\n    drawArrows(ctx, wCss, hCss);\r\n    drawPlayers(ctx, wCss, hCss);\r\n\r\n    // 3) Draw border decorations (corner markers and lines)\r\n    drawBorderDecorations(ctx, wCss, hCss);\r\n\r\n    // Add subtle watermark\r\n    ctx.save();\r\n    ctx.font = '12px \"Segoe UI\", Arial, sans-serif';\r\n    ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n    ctx.textAlign = 'right';\r\n    ctx.fillText(`Formation Lab ${FLAB.version}`, wCss - 10, hCss - 10);\r\n    ctx.restore();\r\n\r\n    // 3) Convert to data URL and download\r\n    let url;\r\n    try {\r\n      url = canvas.toDataURL('image/png');\r\n    } catch (error) {\r\n      throw new Error('Failed to create image data. Canvas may be too large.');\r\n    }\r\n\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `formation-${Date.now()}.png`;\r\n    a.click();\r\n\r\n    // Success!\r\n    hideSpinner(spinnerId);\r\n    showSuccessToast(\"Formation exported successfully!\");\r\n\r\n    logTelemetry(\"export_png\", {\r\n      width: canvas.width,\r\n      height: canvas.height,\r\n      arrows: FLAB.arrows.length,\r\n      dpr,\r\n      success: true\r\n    });\r\n\r\n  } catch (error) {\r\n    hideSpinner(spinnerId);\r\n    handleError(error, 'export', true);\r\n    showErrorToast('Export failed. Please try again.');\r\n\r\n    logTelemetry(\"export_png\", {\r\n      error: error.message,\r\n      success: false\r\n    });\r\n  }\r\n}\r\n\r\nwindow.__mod_export = true;"],
  "mappings": "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",
  "names": ["FLAB", "PITCH_LAND", "PITCH_PORT", "PASS", "normToView", "getVar", "insetFromA", "insetFromB", "ARROW_ASSETS", "headPxFor", "headTrimPx", "showSpinner", "hideSpinner", "handleError", "showSuccessToast", "showErrorToast", "JERSEY_SIZE", "BLEED", "jerseyImg", "getPlayer", "playerId", "player", "__name", "showToast", "message", "logTelemetry", "event", "data", "drawBorderDecorations", "ctx", "wCss", "hCss", "primaryColor", "corner", "index", "applyCanvasPassStyle", "s", "clamp", "v", "min", "max", "recolorSVG", "svgText", "fillColor", "strokeColor", "getColoredImage", "styleKey", "asset", "coloredSVG", "img", "drawHeadCanvas", "A", "B", "len", "isComic", "head", "ang", "shaftColor", "outlineColor", "ensureJerseyReady", "error", "resolve", "reject", "drawJersey", "x", "y", "size", "numText", "half", "scale", "chipRadius", "offset", "chipX", "chipY", "drawArrows", "width", "height", "passColor", "avgScale", "arrow", "fromPlayer", "bleed", "passerVx", "passerVy", "passerCenter", "scaleX", "scaleY", "targetCenter", "exportHaloR", "exportStartGap", "exportEndGap", "exportTargetR", "Btip", "headPx", "trim", "dx", "dy", "L", "Bshaft", "scaledControl", "drawPlayers", "sizeScale", "r", "vx", "vy", "exportPNG", "spinnerId", "field", "dpr", "canvas", "pitchSrc", "url", "a"]
}
